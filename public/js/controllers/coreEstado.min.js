var my_angular_app=angular.module("my_angular_app",[]);my_angular_app.service("coneccion",function(){var a=io(),r={};a.on("manzanasFiltradas",function(a){r[a.guid](a.geojson),delete r[a.guid]}),a.on("reportesPorManzanasFiltradas",function(a){r[a.guid](a.geojson),delete r[a.guid]});var o=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},l=function(l){var n=o();r[n]=l.callback,l.caller=n,a.emit("llamarManzanas",l)},n=function(l){var n=o();r[n]=l.callback,l.caller=n,a.emit("llamarReportesPorManzanas",l)};return{llamarFiltroManzanas:l,llamarFiltroReportesPorManzanas:n}}),my_angular_app.controller("home_controller",["$scope","coneccion",function(a,r){var l,t=(io(),[]),i=[],c={color:"#ff7800",weight:2,opacity:.65},s=function(a){console.log(a),l=L.geoJson(a,{style:c}),p(a),l.addTo(g)},p=function(a){for(var r=0;r<a.length;r++)t.push(a[r].gid),i.push(a[r].totale/47);var o=function(a){switch(a.properties.gid){case t[0]:return{color:"#0f0",fillOpacity:i[0]};case t[1]:return{color:"#0f0",fillOpacity:i[1]};case t[2]:return{color:"#0f0",fillOpacity:i[2]};case t[3]:return{color:"#0f0",fillOpacity:i[3]};case t[4]:return{color:"#0f0",fillOpacity:i[4]};case t[5]:return{color:"#0f0",fillOpacity:i[5]};case t[6]:return{color:"#0f0",fillOpacity:i[6]};case t[7]:return{color:"#0f0",fillOpacity:i[7]};case t[8]:return{color:"#0f0",fillOpacity:i[8]};case t[9]:return{color:"#0f0",fillOpacity:i[9]};case t[10]:return{color:"#0f0",fillOpacity:i[10]}}};l=L.geoJson(a,{style:o})};a.filtrarManzanas=function(){r.llamarFiltroManzanas({callback:s,horaInicial:a.horaInicialFiltro,horaFinal:a.horaFinalFiltro})},r.llamarFiltroReportesPorManzanas({callback:p,horaInicial:0,horaFinal:24}),r.llamarFiltroManzanas({callback:s,horaInicial:0,horaFinal:24});var f="http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",u='Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',g=(new L.TileLayer(f,{maxZoom:18,attribution:u}),L.map("mapEstado").setView([4.607038,-74.068819],16));g.addLayer(new L.TileLayer(f,{maxZoom:18,attribution:u})),g._layersMaxZoom=18,g._layersMinZoom=10,L.control.scale({position:"bottomleft",imperial:!1}).addTo(g)}]);